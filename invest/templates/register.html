{% extends 'base.html' %}
{% load static %}
{% block custom_css %}
<link rel="stylesheet" href="{% static 'css/sweetalert.css' %} ">
<style>
    .card-registration .select-input.form-control[readonly]:not([disabled]) {
        font-size: 1rem;
        line-height: 2.15;
        padding-left: .75em;
        padding-right: .75em;
    }

    .card-registration .select-arrow {
        top: 13px;
    }
    .cascading-right {
        margin-right: -100px;
    }
    .cascading-right{
        
        background: rgba( 253, 251, 251, 0.7 );
        box-shadow: 0 8px 32px 0 rgba( 31, 38, 135, 0.37 );
        backdrop-filter: blur( 3px );
        -webkit-backdrop-filter: blur( 3px );
        border-radius: 10px;
        border: 1px solid rgba( 255, 255, 255, 0.18 );
        z-index:200;
    }
    @media (max-width: 991.98px) {
        .cascading-right {
        margin-right: 0;
        position:absolute;
        }
    }
    .btn-primary{
        background: white;
        color: #F66884;
    }
    .btn-primary:hover {
        background: #F66884;
        color: white;
    }
</style>
{% endblock custom_css %}

{% block content %}

<!-- Section: Design Block -->
<section class="text-center text-lg-start">
    
  
    <!-- Jumbotron -->
    <div class="container py-4">
      <div class="row g-0 align-items-center">
        <div class="col-lg-6 mb-5 mb-lg-0" style="position: relative;">
          <div class="card cascading-right">
            <div class="card-body p-5 shadow-5">
              <h2 class="fw-bold mb-5">S'inscrire</h2>
              <form class="needs-validation form-group" novalidate id="main-register-form2" method="post">
                {% csrf_token %}
                <!-- <div class="form-row"> -->
                <div class="row">
                    <div class="col-md-12 mb-3 form-group">
                        <label for="validationCustom00" class="float-left">Email:</label>
                        <input type="email" class="form-control" name="email" id="validationCustom00"
                            placeholder="Votre email" value="" required>
                        <div class="valid-feedback">
                            Looks good!
                        </div>
                        <div class="invalid-feedback">
                            SVP mettez un email valide.
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 mb-3">
                        <label for="validationCustom01" class="float-left">Prenom</label>
                        <input type="text" class="form-control" id="validationCustom01" placeholder="Votre prenom"
                            value="" name="prenom" required>
                        <div class="valid-feedback">
                            Looks good!
                        </div>
                        <div class="invalid-feedback">
                            SVP veuillez remplir ce champ.
                        </div>
                    </div>
                    <div class="col-md-12 mb-3">
                        <label for="validationCustom02" class="float-left">Nom:</label>
                        <input type="text" class="form-control" id="validationCustom02" placeholder="Votre nom "
                            value="" name="nom" required>
                        <div class="valid-feedback">
                            Looks good!
                        </div>
                        <div class="invalid-feedback">
                            SVP veuillez remplir ce champ.
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 mb-3">
                        <label for="validationCustomUsername" class="float-left">Téléphone:</label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <!-- <span class="input-group-text">@</span> -->
                                <select name="indicatif" class="input-group-text" id="inputGroupPrepend" id="">
                                    <option value="221" selected="selected">221</option>
                                    <option value="221">222</option>
                                    <option value="221">223</option>
                                </select>
                            </div>
                            <input type="phone" class="form-control" name="phone" id="validationCustomUsername"
                                placeholder="votre numéro" aria-describedby="inputGroupPrepend" required>
                            <div class="invalid-feedback">
                                SVP mettez un numéro valide.
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-6 mb-3">
                        <label for="password" class="float-left">Mot de passe:</label>
                        <input type="password" class="form-control" name="password1" placeholder="Votre mot de passe"
                            id="password" required>
                        <div class="valid-feedback">
                            Looks good!
                        </div>
                        <div class="invalid-feedback">
                            SVP veuillez mettre un mot de passe.
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label for="password2" class="float-left">Confirmer le mot de passe</label>
                        <input type="password" class="form-control" placeholder="Confirmez le mot de passe"
                            id="password2" name="password2" required>
                        <div class="valid-feedback">
                            Looks good!
                        </div>
                        <div class="invalid-feedback">
                            SVP veuillez conirmer votre mot de passe.
                        </div>
                    </div>

                </div>
                
                <button class="btn btn-primary btn-lg float-right" type="submit">Valider</button>
            </form>
            </div>
          </div>
        </div>
  
        <div class="col-lg-6 mb-5 mb-lg-0 d-none d-lg-block">
          <img src="{% static 'img/register_img.jpg' %}" class="w-100 rounded-4 shadow-4"
            alt="" />
        </div>
      </div>
    </div>
    <!-- Jumbotron -->
  </section>
  <!-- Section: Design Block -->

{% endblock %}

{% block custom_js %}
<script src="{% static 'js/jquery-3.5.1.min.js' %} "></script>
<script src="{% static 'js/sweetalert.min.js' %} "></script>
<script src="{% static 'js/custom.js' %} "></script>
<script>
    // Example starter JavaScript for disabling form submissions if there are invalid fields
    (function () {
        'use strict';
        window.addEventListener('load', function () {
            // Fetch all the forms we want to apply custom Bootstrap validation styles to
            var forms = document.getElementsByClassName('needs-validation');
            // Loop over them and prevent submission
            var validation = Array.prototype.filter.call(forms, function (form) {
                form.addEventListener('submit', function (event) {
                    if (form.checkValidity() === false) {
                        event.preventDefault();
                        event.stopPropagation();
                    }
                    form.classList.add('was-validated');
                }, false);
            });
        }, false);
    })();

    $("#main-register-form2").submit(function (e) {
        e.preventDefault()
        let is_confirm = true
        console.log("la valeur de showConfirm: ", is_confirm)
        if ($("#password2").val() != $("#password").val()) {
            showError("les mots de passe ne correspondent pas");
            return;
        }

        if (is_confirm) {
            // showLoader("bg-blue", "Enregistrement en cours");
            $.ajax({
                type: 'POST',
                url: "{% url 'register' %}",
                dataType: "JSON",
                data: new FormData(this),
                processData: false,
                contentType: false,
                success: function (response) {
                    if (response.status == 1) {
                        // hideLoader();
                        //   $("#add_objet").trigger('reset')
                        showInfo(response.message)
                    }
                    else {
                        // hideLoader();
                        showError(response.message);
                    }
                },
                error: function (response) {
                    // alerter l'erreur
                    alert("error");
                }
            })
        } else {
            return false
        }
    })
</script>

{% endblock custom_js %}